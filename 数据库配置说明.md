# 数据库配置说明

## 问题诊断

当前数据库连接失败，错误信息：`Access denied for user 'root'@'localhost' (using password: NO)`

这说明：
1. **密码配置为空**：当前配置中 `PASSWORD` 字段为空字符串
2. **MySQL root用户需要密码**：你的MySQL root用户设置了密码，但配置文件中没有提供

## 解决方案

### 方案1：在配置文件中设置正确的密码（推荐）

编辑 `HSystem/settings.py`，找到数据库配置部分：

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'real_estate_system',
        'USER': 'root',
        'PASSWORD': '你的MySQL密码',  # 修改这里，填入你的MySQL root密码
        'HOST': 'localhost',
        'PORT': '3306',
        'OPTIONS': {
            'charset': 'utf8mb4',
        },
    }
}
```

### 方案2：如果MySQL root用户确实没有密码

如果你的MySQL root用户确实没有密码，需要确保：
1. MySQL允许无密码登录
2. 配置文件中 `PASSWORD` 保持为空字符串 `''`

### 方案3：创建新的MySQL用户（推荐用于生产环境）

在MySQL中创建一个专门用于此项目的用户：

```sql
-- 登录MySQL
mysql -u root -p

-- 创建数据库
CREATE DATABASE real_estate_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 创建用户并授权
CREATE USER 're_user'@'localhost' IDENTIFIED BY '你的密码';
GRANT ALL PRIVILEGES ON real_estate_system.* TO 're_user'@'localhost';
FLUSH PRIVILEGES;
```

然后在 `settings.py` 中使用新用户：

```python
'USER': 're_user',
'PASSWORD': '你的密码',
```

## 验证配置

修改配置后，运行以下命令验证：

```bash
python check_config.py
```

如果配置正确，应该能看到密码长度不为0。

然后测试数据库连接：

```bash
python test_db_connection.py
```

## 常见问题

### Q: 如何查看MySQL root密码？

如果你忘记了MySQL root密码，可以：
1. 查看MySQL配置文件（通常在 `my.ini` 或 `my.cnf`）
2. 或者重置MySQL root密码

### Q: 如何重置MySQL root密码？

Windows下重置MySQL root密码：

1. 停止MySQL服务
2. 以跳过权限表的方式启动MySQL：
   ```bash
   mysqld --skip-grant-tables
   ```
3. 在另一个命令行窗口连接MySQL：
   ```bash
   mysql -u root
   ```
4. 执行以下SQL：
   ```sql
   USE mysql;
   UPDATE user SET authentication_string=PASSWORD('新密码') WHERE User='root';
   FLUSH PRIVILEGES;
   EXIT;
   ```
5. 重启MySQL服务

### Q: 如何检查MySQL是否运行？

Windows下：
```bash
net start | findstr MySQL
```

或者：
```bash
mysqladmin -u root -p status
```

